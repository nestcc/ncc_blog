---
title: ep44
date: 2020-08-22 10:11:51
tags: 
    - Euler problems
categories:
    - [Dev, Algorithm]
---
# [Problem 44](https://projecteuler.net/problem=44)

---

**Pentagon numbers**

Pentagonal numbers are generated by the formula, `Pn=n(3n−1)/2`. The first ten pentagonal numbers are:

1, 5, 12, 22, 35, 51, 70, 92, 117, 145, ...

It can be seen that P4 + P7 = 22 + 70 = 92 = P8. However, their difference, 70 − 22 = 48, is not pentagonal.

Find the pair of pentagonal numbers, `Pj` and `Pk`, for which their sum and difference are pentagonal and `D = |Pk − Pj|` is  minimised; what is the value of D?

# 动态枚举上界

先枚举出五边形数字

$$
1, 5, 12, 22, 35, 51, 70, 92, 117, 145, ...
$$

双指针从前向后走，如果差值大于D则直接跳过。

```c++
#include <iostream>
#include <cinttypes>

int64_t penta(int n) {
    return n * (3 * n - 1) / 2;
}


int bs_penta(int64_t (*func)(int), int64_t n, int64_t x) {
    int64_t left = 1, right = n, mid;
    while (left <= right) {
        mid = (left + right) >> 1;
        if (func(mid) == x) {
            return 1;
        }
        if (func(mid) < x) {
            left = mid + 1;
        }
        else {
            right = mid - 1;
        }
    }
    return 0;
}

int main() {
    int64_t index = 2, res = INT32_MAX, pi, pj;

    for (int64_t i = 2; penta(i) - penta(i - 1) < res; i += 1) {
        pi = penta(i);

        for (int64_t j = i - 1; j >= 1; j -= 1) {
            pj = penta(j);
            if (pj - pi >= res) {
                break;
            }

            int flag = 1;
            flag = bs_penta(penta, 2 * i, pi + pj);
            flag = flag && bs_penta(penta, i, pi - pj);
            flag && (res = pi - pj);
        }
    }

    std::cout << res << std::endl;
    return 0;
}
```
